@import "variables.less";

// Content
// -------------------------


///// Global styles /////

html {
    font-size: 62.5%;
    line-height: 1.7;
    -webkit-text-size-adjust: 100%;
}

body {
    opacity: 0;
    padding: 0;
    margin: 0 auto;

    // Fade in opacity when ready
    &.ready {
        -webkit-transition: opacity 3s ease;
        -moz-transition: opacity 3s ease;
        -ms-transition: opacity 3s ease;
        -o-transition: opacity 3s ease;
        transition: opacity 3s ease;
        opacity: 1;
    }

    * {
        box-sizing: border-box;
    }
}

img {
    max-width: 100%;
}

h1, h2, h3 {
    .gotham();
}

u {
    // Unfortunate Google doc formatting hack
    text-decoration: none;
}

a {
    color: @link-blue;
    text-decoration: none;

    &:hover {
        color: @link-active;
    }
}

.story-well-sizing() {
    max-width: 750px;
    padding-left: 15px;
    padding-right: 15px;
    margin-left: auto;
    margin-right: auto;
}

.inset-sizing() {
    max-width: 550px;
    padding-left: 15px;
    padding-right: 15px;
    margin-left: auto;
    margin-right: auto;
}

.hide {
    display: none;
}

////// SHORT CODES- these styles correspond to the shortcode markup that is generated from the google doc. This content lives inside the episode-wrapper div and in the intro. ///////
.image-wrapper {
    background-color: #f1f1f1;
    &:after {
        content: 'loading';
        display: block;
        .gotham();
        padding: 1.5em 0;
        text-align: center;
        font-size: 14px;
        text-transform: uppercase;
        font-weight: bold;
        color: #c3c3c3;
        width: 100%;
        position: absolute;
        top: 0;
        left: 0;
    }
}

.embed-image {
    margin-top: 3rem;
    margin-bottom: 3rem;

    &.full {
        margin: 2em 0;
        width: 100%;

        .caption {
            padding-left: 5px;
        }
    }

    &.centered {
        .story-well-sizing();

        &.bottom {
            margin-top: -2rem;

            @media @screen-small {
                margin-top: -2.7rem;
            }
        }
    }

    .composition {
        display: flex;
        flex-direction: row;
        justify-content: space-between;

        .collage2 {
            width: 49.5%;
        }

        @media @screen-small {
            flex-direction: column;

            .collage2 {
                width: 100%;
                &:first-child {
                    margin-bottom: .8rem;
                }
            }
        }

        &.scale {
            flex-direction: row;
            .collage2 {
                width: 49.5%;
                &:first-child {
                    margin-bottom: 0;
                }
            }
        }
    }

    .image-wrapper {
        width: 100%;
        padding-bottom: 56.5%;
        position: relative;
        background-color: #f1f1f1;
        margin: 0 auto;

        > * {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
        }

        &.loaded {
            img {
                display: block;
            }
            &:after {
                content: none;
            }
        }
    }

    img {
        display: none;
    }

    p {
        .sans-serif();
        -webkit-font-smoothing: auto;
        color: @textgray;

        &.image-caption {
            .gotham();
            font-size: .9rem;
            line-height: 1.7;
            margin: 0 auto 2px;
            padding: 4px 0 0;
            max-width: none;

            @media @screen-small-above {
                font-size: 1.2rem;
                padding: 12px 0 0;
            }
        }
    }
}

/////VIDEO-WRAPPER- used for both the title card video and full width looping background videos in the content well/////
.video-wrapper {
    width: 100%;

    &.centered {
        .story-well-sizing();
    }

    &.video-intro {
        height: 100vh;
        video {
            height: 100%;
            object-fit: cover;
        }
    }

    &.video-background {
        position: relative;

        p {
            .sans-serif();
            -webkit-font-smoothing: auto;
            color: @textgray;

            &.video-caption {
                .gotham();
                font-size: .9rem;
                line-height: 1.7;
                margin: 0 auto 2px;
                padding: 4px 2px 0 5px;
                max-width: none;

                @media @screen-small-above {
                    padding: 6px 2px 0 5px;
                    font-size: 1.2rem;
                }
            }
        }
    }
}


/////////// TOP-NAV Fixed position nav that appears upon entering the title card for each character ////////////////
.top-nav {
    .gotham();
    display: none;
    opacity: 0;
    background-color: #fff;
    position: fixed;
    top: 0;
    left: 0;
    line-height: 33px;
    min-height: 38px;
    width: 100%;
    z-index: 10;
    box-shadow: 0 2px 7px rgba(0, 0, 0, .2);

    img {
        padding: 0 1em;
        vertical-align: middle;
        opacity: .6;
        max-width: 7rem;
    }

    .nav-text {
        padding: 0;
        display: inline-block;
        color: #777;
    }

    .nav-head {
        font-weight: bold;
        text-transform: uppercase;
        padding-right: .5rem;
        &::after {
            padding: 5px;
            font-family: npr-app-template;
            content: '\f107';
            display: inline-block;
            transform: rotate(270deg);
        }
    }

    .menu {
        display: none;
        position: absolute;
        width: 100vw;
        line-height: normal;
        background-color: #fff;
        z-index: 10;
        padding: 0 1em;
        border-bottom: 1px solid #ddd;


        .menu-episode {
            font-size: 1rem;
            border-top: 1px solid #eee;
            padding: 1rem 0;

            @media @screen-small-above {
                border-top: none;
                float: left;
                margin-right: 2rem;
                padding: 0;
            }

            .menu-title {
                margin-top: .3rem;
            }
        }

        .episode-link {
            color: #555;
            margin-bottom: 0px;
        }

        .irakli-header-link {
            .irakli & {
                font-weight: bold;
                color: #222;
            }
        }

        .ana-header-link {
            .ana & {
                font-weight: bold;
                color: #222;
            }
        }

        .veriko-header-link {
            .veriko & {
                font-weight: bold;
                color: #222;
            }
        }

    }

    &.active {
        display: block;
        opacity: 1;
        animation-duration: 1.1s;
        animation-fill-mode: both;
        animation-name: slideInDown;

        @keyframes slideInDown {
          from {
            transform: translate3d(0, -100%, 0);
            visibility: visible;
          }

          to {
            transform: translate3d(0, 0, 0);
          }
        }

        // Use hover only to signal interaction
        .nav-text:hover {
            cursor: pointer;

            span {
                color: @black;
            }
        }

        // &.menu-visible, &:not(.menu-visible)&:hover {
        &.menu-visible {
            transition: opacity .5s ease;
            opacity: 1;

            .menu {
                display: block;

                .episode-link {
                    &:hover {
                        cursor: pointer;
                        color: #000;
                    }
                }
            }

            .nav-head {
                font-weight: bold;
                &::after {
                    transform: rotate(0deg);
                }
            }
        }
    }
}


/////////// INTRO- Wrapper div for all intro and episode title card panels. ///////////
#intro {
    position: relative;

    //BG-IMG divs contain the background images for the project title card and episode title cards. The positioning of the background images is dynamically assigned based on what is currently visible in the user's viewport. The titlecard text can be found nested inside the intro-wrapper div
    .bg-img {
        width: 100%;
        height: 100vh;
        position: absolute;
        background-size: cover;
        background-position: center;

        //bg-static is the default class
        &.bg-static {
            visibility: hidden;
            opacity: 0;
            position: fixed;

            //bg-active is used on the project titlecard and episode titlecards when they are in visible in the user's viewport
            &.bg-active {
                visibility: visible;
            }

            //bg-title is only used on the project titlecard
            &.bg-title {
                opacity: 1;
                bottom: 0;
                background: #000;

                #intro-vid {
                    opacity: .6;

                    @media @screen-small-above {
                        opacity: .8;
                    }
                }
            }

            //Class that is applied to an episode title card once the title card enters the viewport
            &.bg-end {
                position: absolute;
                bottom: 0;
            }

            //////Episode title card images////////////

            &.bg-irakli {
                background-image: url('https://media.npr.org/idp-georgia/irakli-title-crop.jpg');

                background-position: bottom;

                // use a different Irakli image on touch devices to accommodate narrow portrait and shallow landscape viewports
                .touchevents & {
                    background-position: center;
                    background-image: url('https://media.npr.org/idp-georgia/irakli-title-mobile.jpg');
                }

            }

            &.bg-ana {
                background-image: url('https://media.npr.org/idp-georgia/ana-title.jpg');

                @media @screen-small {
                    background-position: center;
                }
            }

            &.bg-veriko {
                background-image: url('https://media.npr.org/idp-georgia/veriko_final_photos/VERIKO_UPDATE/20170316-GEORGIA_DSC4053_edit2.jpg');


                @media @screen-small {
                    background-position: top left 30%;
                }
            }
        }
    }

    /////INTRO-WRAPPER is a wrapper div that houses all content in the intro that is not a background image/video
    .intro-wrapper {
        position: relative;
        .gotham();

        //PANEL-INTRO is a generic intro class that is assigned to each panel in the intro regarless of its contents.
        .panel-intro {
            position: relative;
            width: 100%;
            height: 100%;
            height: 100vh;

            //TEXT-WRAPPER is a generic intro class that positions the main content of a panel inside a panel-intro div.
            .text-wrapper {
                display: block;
                opacity: 0;
                position: absolute;
                left: 0;
                top: 50%;
                width: 100%;
                -webkit-transform: translateY(-50%);
                -ms-transform: translateY(-50%);
                transform: translateY(-50%);
                // text-align: center;
                padding: 0 1em;
                color: @black;

                h1 {
                    color: @brightwhite;
                    font-size: 7rem;
                    font-weight: bold;
                    text-transform: uppercase;
                    text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
                    margin: 0;
                }

                p {
                    font-size: 1.7rem;
                    line-height: 1.6;
                    max-width: 630px;
                    margin: 0 auto 1em;
                    text-align: center;

                    @media @screen-small {
                        font-size: 1.4rem;
                    }

                    @media @screen-landscape {
                        font-size: 1.3rem;
                        max-width: 480px;
                    }
                }
            }

            //TITLE-PANEL- A unique class for the title card of the project.
            &.title-panel {

                .text-wrapper {
                    top: 50%;
                    text-align: center;
                    color: #fff;
                    text-shadow: 1px 1px 1px rgba(0, 0, 0, .6);

                    .top-nav-logo {
                        max-width: 7rem;
                    }

                    h1 {
                        font-size: 3.5rem;
                        color: #fff;
                        line-height: 1;
                        margin: .5rem 0 2rem 0;
                    }

                    h5 {
                        font-size: 1.2rem;
                        margin: 1rem 0 0 0;
                        text-transform: uppercase;
                        font-style: italic;
                    }

                    p {
                        font-size: 1.3rem;
                        max-width: 31rem;
                        margin-bottom: 1rem;
                    }

                    @media @screen-tiny-above {

                        p {
                            font-size: 1.6rem;
                            max-width: 1000px;
                        }
                    }

                    @media @screen-small-above {
                        -webkit-transform: translateY(0);
                        -ms-transform: translateY(0);
                        transform: translateY(0);
                        top: auto;
                        bottom: 10%;
                        text-align: left;
                        padding-left: 30px;

                        .top-nav-logo {
                            max-width: 8rem;

                        }

                        h1 {
                            font-size: 5rem;
                        }

                        h5 {
                            font-size: 1.4rem;
                            margin: 1rem 0 0 0;
                        }

                        p {
                            font-size: 2rem;
                            margin: 0 0 1rem 0;
                            text-align: left;
                        }
                    }
                }
            }

            //PANEL-MAP- A unique class for the Georgia locator map panel
            &.panel-map {
                .asset-wrapper {
                    margin: 0 auto;
                }

                .map-wrapper {
                    position: relative;
                    margin: 0 auto;
                    max-width: 80%;
                    height: 50vh;
                    max-height: 466px;
                    width: auto;


                    @media @screen-landscape-above {
                        max-width: 700px;
                        padding-top: .5rem;
                    }

                    img.intro-map {
                        width: auto;
                        margin: 0 auto;
                        display: block;
                        height: 50vh;
                        max-width: 700px;
                        max-height: 466px;
                    }

                    img.inset-map {
                        position: absolute;
                        top: 0;
                        right: 0;
                        max-width: 25%;
                    }

                    .panel-portrait & {
                        height: auto;
                        width: 80%;
                        max-width: 700px;

                        img.intro-map {
                            height: auto;
                            width: 100%;
                        }

                    }

                }
            }

            //PANEL-CHARACTERS- A unique class for the panel containing thumbnail images of the characters in each episode
            &.panel-characters {
                .asset-wrapper {
                    .clearfix();
                    .story-well-sizing();
                    text-align: center;
                    opacity: 1;

                    .char-wrapper {
                        display: inline-block;
                        position: relative;
                        text-align: center;
                        width: 33%;
                        padding: 0 0.5em;
                        opacity: 1;
                        transition: opacity 1s ease-in;

                        &.not-active {
                            opacity: 0;
                            transition: opacity 1s ease-out;
                        }

                        img {
                            display: block;
                        }

                        span {
                            display: inline-block;
                            margin: 0 auto;
                            color: #222;
                            text-transform: uppercase;
                            font-size: 1rem;
                            line-height: 1.5;
                            padding-top: 1rem;

                            @media @screen-tiny-above {
                                font-weight: bold;
                                line-height: 1.5;
                                font-size: 1.6rem;
                                padding-top: 0;
                                color: @brightwhite;
                                position: absolute;
                                bottom: 15px;
                                left: 0;
                                right: 0;
                            }
                        }
                    }
                }
            }

        }

        //INTRO-CUSTOM is an ID that is assigned to the episode title card for each episode. The background image for the panel lives in a separate div with a class of bg-img
        &#intro-custom {
            .text-wrapper {
                top: auto;
                bottom: 0;
                position: absolute;

                &.pinned {
                    position: fixed;
                }
            }

            h2 {
                font-size: 4.5rem;
                font-weight: bold;
                line-height: 1;
                text-transform: uppercase;
                color: @brightwhite;
                margin: 0 auto 1rem;
                text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
                text-align: center;

                @media @screen-small {
                    font-size: 2.5rem;
                }
            }

            p {
                color: @brightwhite;
                max-width: 600px;
                padding-left: 15px;
                padding-right: 15px;
                margin-left: auto;
                margin-right: auto;
                -webkit-font-smoothing: antialiased;
                font-size: 1.8rem;
                font-style: italic;
                line-height: 1.7;
                text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
                text-align: center;

                @media @screen-small {
                    font-size: 1.3rem;
                    // line-height: 1.5;
                }
            }
        }
    }
}



// EPISODE-CONTENT is the wrapper div for the main content of each episode. It includes all content after the episode title card (#episode-title) and befire the footer (#footer)
.episode-content {

    //INLINE-INTRO is a div that contains prelude text that appears below the episode title card. It is paired with a locator map that shows the location of displacement for the current character.
    .inline-intro {
        .inset-sizing();
        padding: 4em 0;
        margin: 0 auto 6em;
        border-bottom: 5px solid #eee;

        @media @screen-small {
            padding: 2em 0;
            border-bottom: 2px solid #eee;
            margin: 0 15px;
        }

        p {
            font-style: italic;
            font-size: 1.6rem;
            text-align: center;

            @media @screen-small {
                font-size: 1.3rem;
            }

        }

        //CHAR-MAP is a div that contains the locator map and caption that shows the location of displacement for the current character.
        .char-map {
            padding: 0 15px;
            margin-left: auto;
            margin-right: auto;
            max-width: 600px;

            img {
                border: 1px solid #ddd;
            }

            p.image-caption {
                .gotham();
                font-size: .9rem;
                line-height: 1.7;
                margin: 0 auto 2px;
                padding: 4px 0 0;
                text-align: left;
                font-style: normal;

                @media @screen-small-above {
                    font-size: 1.2rem;
                    padding: 12px 0 0;
                }
            }


        }
    }

    h2 {
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        font-weight: bold;
    }
    h3, p {
        .story-well-sizing();
    }

    p {
        font-family: Georgia, serif;
        font-size: 1.8rem;
        -webkit-font-smoothing: antialiased;
        margin-bottom: 1.2em;
        color: #333;

        @media @screen-small {
            font-size: 1.3rem;
        }
    }
}

//FOOTER- the footer contains the question at the end of each episode (.footer-question) that links to the next episode, boilerplate info, and project credits.
#footer {
    // background-color: #eee;
    // border-top: 1px solid #ddd;
    margin-top: 3rem;
    .gotham();

    //call to action to visit the next story
    .footer-question {
        padding: 5rem 15px 0 15px;
        margin: 0 15px;
        padding-bottom: 2rem;
        border-top: 2px solid #eee;

        @media @screen-small-above {
            margin: 0 auto;
            max-width: 750px;
            border-top: 3px solid #eee;
        }

        //next episode thumbnail
        img {
            border: 1px solid #ddd;
            margin-bottom: 1rem;


            @media @screen-tiny-above {
                width: 25rem;
                float: left;
                margin-bottom: 5rem;
            }
        }

        // text  to the right of the episode thumbnail
        .next-story-action {

            @media @screen-tiny-above {
                margin-left: 28rem;
            }

            h4 {
                font-size: 1.2rem;
                line-height: 1.5;
                font-weight: normal;
                color: #555;
                margin: 0 0 1rem 0;
                padding: 0;

                @media @screen-tiny-above {
                    font-size: 1.3rem;
                }

            }

            h3 {
                font-weight: bold;
                font-size: 1.3rem;
                line-height: 1.2;
                margin: 0 0 0 0;
                padding: 0;

                @media @screen-tiny-above {
                    font-size: 1.5rem;
                }
            }



        }


    }

    //BOILERPLATE- shared footer links and credits that appear across all episodes
    .boilerplate {
        border-top: 1px solid #ddd;
        background: #eee;
        clear: both;
    }

    //UTILITY-NAV- links to each episode in the project
    .utility-nav {
        max-width: 750px;
        margin: 0 auto;
        margin-top: 2rem;
        padding: 0 15px;
        padding-top: 1rem;

        p {
            color: #888;
            font-size: 1.4rem;
            margin: 0;
            padding: 1rem 0;


            a {
                font-size: 1.2rem;
                padding-right: 2rem;
                color: #888;
                text-decoration: none;
                display: block;

                &:hover {
                    .no-touchevents & {
                        color: #666;
                    }
                }

                @media @screen-small-above {
                    display: inline-block;
                }
            }

            b {
                text-transform: uppercase;
                display: block;
                padding-right: 2rem;
            }
        }
    }

    //CREDITS- project credits
    .credits {
        clear: both;
        max-width: 750px;
        margin: 0 auto;
        margin-top: 1rem;
        padding: 0 15px 2rem 15px;

        p {
            color: #888;
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
            padding: 0;

            a {
                color: #666;
                font-weight: bold;
            }

            b {
                text-transform: uppercase;
            }
        }
    }
}
